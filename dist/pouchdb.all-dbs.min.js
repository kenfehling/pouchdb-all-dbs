!function(e){"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(e):"undefined"!=typeof window?window.PouchDBAllDBs=e():"undefined"!=typeof global?global.PouchDBAllDBs=e():"undefined"!=typeof self&&(self.PouchDBAllDBs=e())}(function(){return function e(t,n,r){function o(u,s){if(!n[u]){if(!t[u]){var c="function"==typeof require&&require;if(!s&&c)return c(u,!0);if(i)return i(u,!0);throw new Error("Cannot find module '"+u+"'")}var f=n[u]={exports:{}};t[u][0].call(f.exports,function(e){var n=t[u][1][e];return o(n?n:e)},f,f.exports,e,t,n,r)}return n[u].exports}for(var i="function"==typeof require&&require,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(e,t,n){"use strict";function r(e){return s+e}function o(e){return e.slice(s.length)}var i=e("./pouch-utils"),u=e("./taskqueue"),s="db_";t.exports=function(e){function t(e){e&&console.error(e)}function n(){h.add(function(t){return a?t():void new e(p).then(function(e){a=e,t()})["catch"](function(e){console.error(e),t(e)})})}function c(e){return e.replace(/^_pouch_/,"")}function f(e){return e===p||-1!==e.indexOf("-mrview-")||/^https?:\/\//.test(e)}var a,l,p="pouch__all_dbs__",h=new u;e.on("created",function(e){e=c(e),f(e)||(e=r(e),n(),h.add(function(t){a.get(e).then(function(){})["catch"](function(t){if("not_found"!==t.name)throw t;return a.put({_id:e})}).then(function(){l&&(l[e]=!0),t()},t)},t))}),e.on("destroyed",function(e){e=c(e),f(e)||(e=r(e),n(),h.add(function(t){a.get(e).then(function(e){return a.remove(e)})["catch"](function(e){if("not_found"!==e.name)throw e}).then(function(){l&&delete l[e],t()},t)},t))}),e.allDbs=i.toPromise(function(e){n(),h.add(function(e){if(l)return e(null,Object.keys(l).map(o));var t={startkey:s,endkey:s+"ï¿¿"};a.allDocs(t).then(function(t){l={};var n=[];t.rows.forEach(function(e){n.push(o(e.key)),l[e.key]=!0}),e(null,n)})["catch"](function(t){console.error(t),e(t)})},e)}),e.resetAllDbs=i.toPromise(function(e){h.add(function(e){a.destroy().then(function(){a=null,l=null,e()})["catch"](function(t){console.error(t),e(t)})},e)})},"undefined"!=typeof window&&window.PouchDB&&t.exports(window.PouchDB)},{"./pouch-utils":20,"./taskqueue":21}],2:[function(e,t,n){"use strict";function r(e){return function(){var t=arguments.length;if(t){for(var n=[],r=-1;++r<t;)n[r]=arguments[r];return e.call(this,n)}return e.call(this,[])}}t.exports=r},{}],3:[function(e,t,n){var r=t.exports={};r.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(e){n.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")}},{}],4:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],5:[function(e,t,n){"use strict";function r(){}t.exports=r},{}],6:[function(e,t,n){"use strict";function r(e){function t(e,t){function o(e){f[t]=e,++a===n&!r&&(r=!0,c.resolve(p,f))}u(e).then(o,function(e){r||(r=!0,c.reject(p,e))})}if("[object Array]"!==Object.prototype.toString.call(e))return i(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return u([]);for(var f=new Array(n),a=0,l=-1,p=new o(s);++l<n;)t(e[l],l);return p}var o=e("./promise"),i=e("./reject"),u=e("./resolve"),s=e("./INTERNAL"),c=e("./handlers");t.exports=r},{"./INTERNAL":5,"./handlers":7,"./promise":9,"./reject":12,"./resolve":13}],7:[function(e,t,n){"use strict";function r(e){var t=e&&e.then;return e&&"object"==typeof e&&"function"==typeof t?function(){t.apply(e,arguments)}:void 0}var o=e("./tryCatch"),i=e("./resolveThenable"),u=e("./states");n.resolve=function(e,t){var s=o(r,t);if("error"===s.status)return n.reject(e,s.value);var c=s.value;if(c)i.safely(e,c);else{e.state=u.FULFILLED,e.outcome=t;for(var f=-1,a=e.queue.length;++f<a;)e.queue[f].callFulfilled(t)}return e},n.reject=function(e,t){e.state=u.REJECTED,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e}},{"./resolveThenable":14,"./states":15,"./tryCatch":16}],8:[function(e,t,n){t.exports=n=e("./promise"),n.resolve=e("./resolve"),n.reject=e("./reject"),n.all=e("./all"),n.race=e("./race")},{"./all":6,"./promise":9,"./race":11,"./reject":12,"./resolve":13}],9:[function(e,t,n){"use strict";function r(e){if(!(this instanceof r))return new r(e);if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=s.PENDING,this.queue=[],this.outcome=void 0,e!==i&&u.safely(this,e)}var o=e("./unwrap"),i=e("./INTERNAL"),u=e("./resolveThenable"),s=e("./states"),c=e("./queueItem");t.exports=r,r.prototype["catch"]=function(e){return this.then(null,e)},r.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s.FULFILLED||"function"!=typeof t&&this.state===s.REJECTED)return this;var n=new r(i);if(this.state!==s.PENDING){var u=this.state===s.FULFILLED?e:t;o(n,u,this.outcome)}else this.queue.push(new c(n,e,t));return n}},{"./INTERNAL":5,"./queueItem":10,"./resolveThenable":14,"./states":15,"./unwrap":17}],10:[function(e,t,n){"use strict";function r(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}var o=e("./handlers"),i=e("./unwrap");t.exports=r,r.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},r.prototype.otherCallFulfilled=function(e){i(this.promise,this.onFulfilled,e)},r.prototype.callRejected=function(e){o.reject(this.promise,e)},r.prototype.otherCallRejected=function(e){i(this.promise,this.onRejected,e)}},{"./handlers":7,"./unwrap":17}],11:[function(e,t,n){"use strict";function r(e){function t(e){u(e).then(function(e){r||(r=!0,c.resolve(a,e))},function(e){r||(r=!0,c.reject(a,e))})}if("[object Array]"!==Object.prototype.toString.call(e))return i(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return u([]);for(var f=-1,a=new o(s);++f<n;)t(e[f]);return a}var o=e("./promise"),i=e("./reject"),u=e("./resolve"),s=e("./INTERNAL"),c=e("./handlers");t.exports=r},{"./INTERNAL":5,"./handlers":7,"./promise":9,"./reject":12,"./resolve":13}],12:[function(e,t,n){"use strict";function r(e){var t=new o(i);return u.reject(t,e)}var o=e("./promise"),i=e("./INTERNAL"),u=e("./handlers");t.exports=r},{"./INTERNAL":5,"./handlers":7,"./promise":9}],13:[function(e,t,n){"use strict";function r(e){if(e)return e instanceof o?e:u.resolve(new o(i),e);var t=typeof e;switch(t){case"boolean":return s;case"undefined":return f;case"object":return c;case"number":return a;case"string":return l}}var o=e("./promise"),i=e("./INTERNAL"),u=e("./handlers");t.exports=r;var s=u.resolve(new o(i),!1),c=u.resolve(new o(i),null),f=u.resolve(new o(i),void 0),a=u.resolve(new o(i),0),l=u.resolve(new o(i),"")},{"./INTERNAL":5,"./handlers":7,"./promise":9}],14:[function(e,t,n){"use strict";function r(e,t){function n(t){s||(s=!0,o.reject(e,t))}function r(t){s||(s=!0,o.resolve(e,t))}function u(){t(r,n)}var s=!1,c=i(u);"error"===c.status&&n(c.value)}var o=e("./handlers"),i=e("./tryCatch");n.safely=r},{"./handlers":7,"./tryCatch":16}],15:[function(e,t,n){n.REJECTED=["REJECTED"],n.FULFILLED=["FULFILLED"],n.PENDING=["PENDING"]},{}],16:[function(e,t,n){"use strict";function r(e,t){var n={};try{n.value=e(t),n.status="success"}catch(r){n.status="error",n.value=r}return n}t.exports=r},{}],17:[function(e,t,n){"use strict";function r(e,t,n){o(function(){var r;try{r=t(n)}catch(o){return i.reject(e,o)}r===e?i.reject(e,new TypeError("Cannot resolve promise with itself")):i.resolve(e,r)})}var o=e("immediate"),i=e("./handlers");t.exports=r},{"./handlers":7,immediate:18}],18:[function(e,t,n){function r(){p=!0;for(var e,t,n=h.length;n;){for(t=h,h=[],e=-1;++e<n;)t[e]();n=h.length}p=!1}function o(e){1!==h.push(e)||p||i()}var i,u="undefined"!=typeof self?self:"undefined"!=typeof window?window:{},s=u.MutationObserver||u.WebKitMutationObserver;if(s){var c=0,f=new s(r),a=u.document.createTextNode("");f.observe(a,{characterData:!0}),i=function(){a.data=c=++c%2}}else if(u.setImmediate||"undefined"==typeof u.MessageChannel)i="document"in u&&"onreadystatechange"in u.document.createElement("script")?function(){var e=u.document.createElement("script");e.onreadystatechange=function(){r(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},u.document.documentElement.appendChild(e)}:function(){setTimeout(r,0)};else{var l=new u.MessageChannel;l.port1.onmessage=r,i=function(){l.port2.postMessage(0)}}var p,h=[];t.exports=o},{}],19:[function(e,t,n){"use strict";function r(){this.length=0}r.prototype.push=function(e){var t={item:e};this.last?this.last=this.last.next=t:this.last=this.first=t,this.length++},r.prototype.shift=function(){var e=this.first;return e?(this.first=e.next,--this.length||(this.last=void 0),e.item):void 0},r.prototype.slice=function(e,t){e="undefined"==typeof e?0:e,t="undefined"==typeof t?1/0:t;for(var n=[],r=0,o=this.first;o&&!(--t<0);o=o.next)++r>e&&n.push(o.item);return n},t.exports=r},{}],20:[function(e,t,n){var r,o=e("__browserify_process"),i="undefined"!=typeof self?self:"undefined"!=typeof window?window:{};r="undefined"!=typeof window&&window.PouchDB?window.PouchDB.utils.Promise:"function"==typeof i.Promise?i.Promise:e("lie"),n.once=function(e){var t=!1;return n.getArguments(function(n){if(t)throw console.trace(),new Error("once called  more than once");t=!0,e.apply(this,n)})},n.getArguments=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=-1;++r<t;)n[r]=arguments[r];return e.call(this,n)}},n.toPromise=function(e){return n.getArguments(function(t){var i,u=this,s="function"==typeof t[t.length-1]?t.pop():!1;s&&(i=function(e,t){o.nextTick(function(){s(e,t)})});var c=new r(function(r,o){try{var i=n.once(function(e,t){e?o(e):r(t)});t.push(i),e.apply(u,t)}catch(s){o(s)}});return i&&c.then(function(e){i(null,e)},i),c.cancel=function(){return this},c})},n.inherits=e("inherits")},{__browserify_process:3,inherits:4,lie:8}],21:[function(e,t,n){function r(){this.queue=new s,this.running=!1}var o=e("__browserify_process"),i="undefined"!=typeof self?self:"undefined"!=typeof window?window:{},u=e("argsarray"),s=e("tiny-queue"),c=i.setImmediate||o.nextTick;r.prototype.add=function(e,t){t=t||function(){},this.queue.push({fun:e,callback:t}),this.processNext()},r.prototype.processNext=function(){var e=this;if(!e.running&&e.queue.length){e.running=!0;var t=e.queue.shift();c(function(){t.fun(u(function(n){t.callback.apply(null,n),e.running=!1,e.processNext()}))})}},t.exports=r},{__browserify_process:3,argsarray:2,"tiny-queue":19}]},{},[1])(1)});
